export const metadata = {
  title: 'Security & Secrets',
  description: 'Components for security operations like encryption, hashing, and secrets management.',
}

export const sections = [
  { title: 'Get Secret', id: 'security-get_secret' },
  { title: 'Encrypt Data', id: 'security-encrypt' },
  { title: 'Decrypt Data', id: 'security-decrypt' },
  { title: 'Hash Data', id: 'security-hash' },
  { title: 'Mask Data', id: 'security-mask_data' },
  { title: 'Validate Certificate', id: 'security-validate_cert' },
  { title: 'Azure Key Vault', id: 'secrets-azure_keyvault' },
  { title: 'AWS Secrets Manager', id: 'secrets-aws_secrets' },
  { title: 'HashiCorp Vault', id: 'secrets-hashicorp_vault' },
  { title: 'Local Vault', id: 'secrets-local_vault' },
]

# Security & Secrets

Components for security operations like encryption, hashing, and secrets management. {{ className: 'lead' }}

<Note>
  This category contains **10 components**. See also: [Compliance](/components/compliance) · [API / HTTP](/components/api) · [Database](/components/database)
</Note>

## Common Use Cases

- Encrypt sensitive data
- Manage API keys securely
- Hash passwords
- Generate secure tokens

---

## Get Secret {{ id: 'security-get_secret' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-key"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4" />
  <path d="m21 2-9.6 9.6" />
  <circle cx="7.5" cy="15.5" r="5.5" />
</svg>
`} label="Get Secret" description="Retrieve secret from vault" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.get_secret`
  </Property>
</Properties>

### When to Use

- Retrieve API keys securely
- Get database passwords
- Access encrypted credentials
- Fetch configuration secrets

### Configuration

<Properties>
  <Property name="name" type="text" required>
    Secret Name
  </Property>
  <Property name="vault" type="select">
    Vault Default: `orchestrator`
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.get_secret",
  "label": "Get Secret",
  "config": {
    "name": "your-name",
    "vault": "orchestrator"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Encrypt Data {{ id: 'security-encrypt' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-lock"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
  <path d="M7 11V7a5 5 0 0 1 10 0v4" />
</svg>
`} label="Encrypt Data" description="Encrypt sensitive data" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.encrypt`
  </Property>
</Properties>

### When to Use

- Encrypt sensitive data before storage
- Protect PII in transit
- Secure data for transmission
- Encrypt files before archiving

### Configuration

<Properties>
  <Property name="data" type="textarea" required>
    Data
  </Property>
  <Property name="key" type="text" required>
    Encryption Key
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.encrypt",
  "label": "Encrypt Data",
  "config": {
    "data": "your-data",
    "key": "your-key"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Decrypt Data {{ id: 'security-decrypt' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-lock-open"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
  <path d="M7 11V7a5 5 0 0 1 9.9-1" />
</svg>
`} label="Decrypt Data" description="Decrypt encrypted data" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.decrypt`
  </Property>
</Properties>

### When to Use

- Decrypt protected data for processing
- Access encrypted files
- Decode secure messages
- Decrypt stored credentials

### Configuration

<Properties>
  <Property name="data" type="textarea" required>
    Encrypted Data
  </Property>
  <Property name="key" type="text" required>
    Decryption Key
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.decrypt",
  "label": "Decrypt Data",
  "config": {
    "data": "your-data",
    "key": "your-key"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Hash Data {{ id: 'security-hash' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-hash"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <line x1="4" x2="20" y1="9" y2="9" />
  <line x1="4" x2="20" y1="15" y2="15" />
  <line x1="10" x2="8" y1="3" y2="21" />
  <line x1="16" x2="14" y1="3" y2="21" />
</svg>
`} label="Hash Data" description="Create data hash" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.hash`
  </Property>
</Properties>

### When to Use

- Hash passwords for storage
- Create data fingerprints
- Generate checksums
- Verify data integrity

### Configuration

<Properties>
  <Property name="data" type="textarea" required>
    Data
  </Property>
  <Property name="algorithm" type="select">
    Algorithm Default: `sha256`
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.hash",
  "label": "Hash Data",
  "config": {
    "data": "your-data",
    "algorithm": "sha256"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Mask Data {{ id: 'security-mask_data' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-eye-off"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49" />
  <path d="M14.084 14.158a3 3 0 0 1-4.242-4.242" />
  <path d="M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143" />
  <path d="m2 2 20 20" />
</svg>
`} label="Mask Data" description="Mask sensitive data in logs" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.mask_data`
  </Property>
</Properties>

### When to Use

- Hide sensitive data in logs
- Mask credit card numbers
- Redact PII for display
- Protect data in reports

### Configuration

<Properties>
  <Property name="pattern" type="text" required>
    Pattern to Mask
  </Property>
  <Property name="mask_char" type="text">
    Mask Character Default: `*`
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.mask_data",
  "label": "Mask Data",
  "config": {
    "pattern": "your-pattern",
    "mask_char": "*"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Validate Certificate {{ id: 'security-validate_cert' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-shield-check"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
  <path d="m9 12 2 2 4-4" />
</svg>
`} label="Validate Certificate" description="Validate SSL certificate" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `security.validate_cert`
  </Property>
</Properties>

### When to Use

- Verify SSL certificates
- Check certificate expiry
- Validate certificate chains
- Ensure secure connections

### Configuration

<Properties>
  <Property name="url" type="text" required>
    URL
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "security.validate_cert",
  "label": "Validate Certificate",
  "config": {
    "url": "your-url"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Azure Key Vault {{ id: 'secrets-azure_keyvault' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-key-round"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z" />
  <circle cx="16.5" cy="7.5" r=".5" fill="currentColor" />
</svg>
`} label="Azure Key Vault" description="Connect to Azure Key Vault (credentials from BotRunner env)" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `secrets.azure_keyvault`
  </Property>
</Properties>

### Configuration

<Properties>
  <Property name="vault_url" type="text" required>
    Vault URL

    Example: `https://myvault.vault.azure.net`
  </Property>
  <Property name="tenant_id" type="text" required>
    Tenant ID

    Example: `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`
  </Property>
  <Property name="client_id" type="text" required>
    Client ID

    Example: `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`
  </Property>
  <Property name="use_managed_identity" type="boolean">
    Use Managed Identity Default: `false`
  </Property>
  <Property name="secrets" type="textarea">
    Secrets to Load

    Example: `db_password\napi_key\nconnection_string`
  </Property>
</Properties>

### Output Variables

Access these variables in subsequent nodes using `${Azure Key Vault.variableName}`.

<Properties>
  <Property name="loaded" type="number">
    Number of secrets loaded
  </Property>
  <Property name="secretNames" type="array">
    Names of loaded secrets
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "secrets.azure_keyvault",
  "label": "Azure Key Vault",
  "config": {
    "vault_url": "https://myvault.vault.azure.net",
    "tenant_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "client_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "use_managed_identity": "false"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## AWS Secrets Manager {{ id: 'secrets-aws_secrets' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-key-round"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z" />
  <circle cx="16.5" cy="7.5" r=".5" fill="currentColor" />
</svg>
`} label="AWS Secrets Manager" description="Connect to AWS Secrets Manager (credentials from BotRunner env or IAM Role)" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `secrets.aws_secrets`
  </Property>
</Properties>

### Configuration

<Properties>
  <Property name="region" type="select">
    AWS Region Default: `us-east-1`
  </Property>
  <Property name="use_iam_role" type="boolean">
    Use IAM Role Default: `true`
  </Property>
  <Property name="secrets" type="textarea">
    Secrets to Load (e.g., `prod/db/password\nprod/api/key`)
  </Property>
</Properties>

### Output Variables

Access these variables in subsequent nodes using `${AWS Secrets Manager.variableName}`.

<Properties>
  <Property name="loaded" type="number">
    Number of secrets loaded
  </Property>
  <Property name="secretNames" type="array">
    Names of loaded secrets
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "secrets.aws_secrets",
  "label": "AWS Secrets Manager",
  "config": {
    "region": "us-east-1",
    "use_iam_role": "true",
    "secrets": "prod/db/password\nprod/api/key"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## HashiCorp Vault {{ id: 'secrets-hashicorp_vault' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-key-round"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z" />
  <circle cx="16.5" cy="7.5" r=".5" fill="currentColor" />
</svg>
`} label="HashiCorp Vault" description="Connect to HashiCorp Vault (credentials from BotRunner env)" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `secrets.hashicorp_vault`
  </Property>
</Properties>

### Configuration

<Properties>
  <Property name="vault_addr" type="text" required>
    Vault Address (e.g., `https://vault.example.com:8200`)
  </Property>
  <Property name="auth_method" type="select">
    Auth Method Default: `token`
  </Property>
  <Property name="mount_point" type="text">
    Secrets Engine Mount (e.g., `secret`) Default: `secret`
  </Property>
  <Property name="secrets_path" type="text" required>
    Secrets Path (e.g., `myapp/prod`)
  </Property>
  <Property name="secrets" type="textarea">
    Keys to Load (optional) (e.g., `db_password\napi_key`)
  </Property>
</Properties>

### Output Variables

Access these variables in subsequent nodes using `${HashiCorp Vault.variableName}`.

<Properties>
  <Property name="loaded" type="number">
    Number of secrets loaded
  </Property>
  <Property name="secretNames" type="array">
    Names of loaded secrets
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "secrets.hashicorp_vault",
  "label": "HashiCorp Vault",
  "config": {
    "vault_addr": "https://vault.example.com:8200",
    "auth_method": "token",
    "mount_point": "secret",
    "secrets_path": "myapp/prod"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

## Local Vault {{ id: 'secrets-local_vault' }}

<NodeHeader icon={`
<svg
  class="lucide lucide-lock"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
  <path d="M7 11V7a5 5 0 0 1 10 0v4" />
</svg>
`} label="Local Vault" description="Unlock local encrypted vault on BotRunner (AES-256-GCM)" bgColor="#fef3c7" textColor="#b45309" />

<Properties>
  <Property name="type" type="string">
    `secrets.local_vault`
  </Property>
</Properties>

### When to Use

- Access locally stored secrets
- Use development credentials
- Load secrets from encrypted local store
- Manage local API keys

### Configuration

<Properties>
  <Property name="vault_path" type="text">
    Vault Path Default: `.skuldbot`

    Example: `.skuldbot or /etc/skuldbot/vault`
  </Property>
  <Property name="secrets" type="textarea">
    Secrets to Load (optional) (e.g., `db_password\napi_key`)
  </Property>
</Properties>

### Output Variables

Access these variables in subsequent nodes using `${Local Vault.variableName}`.

<Properties>
  <Property name="unlocked" type="boolean">
    Vault unlock status
  </Property>
  <Property name="secretCount" type="number">
    Number of secrets loaded
  </Property>
  <Property name="secretNames" type="array">
    Names of loaded secrets
  </Property>
</Properties>

### Example

```json
{
  "id": "node-1",
  "type": "secrets.local_vault",
  "label": "Local Vault",
  "config": {
    "vault_path": ".skuldbot or /etc/skuldbot/vault",
    "secrets": "db_password\napi_key"
  },
  "outputs": {
    "success": "next-node",
    "error": "error-handler"
  }
}
```

---

